<s4e-generic-modal [buttonX]="true" [modalId]="registeredId">
  <div class="s4e-modal-header" i18n>Wczytaj konfiguracje</div>
  <div class="s4e-modal-body">
    <ng-container *ngIf="!(loading$ | async); else loadingRef">
      <div *ngIf="!(hasCustomOverlays$ | async)">
        Nie masz jeszcze żadnej swojej nakładki (Lorem Ipsum, Etc)

        <button [disabled]="showOverlayForm$ | async"
                class="button button--secondary button--small"
                type="button" (click)="showOverlayForm(true)" i18n>Dodaj Nakładkę</button>
      </div>

      <div class="s4e-modal-table" *ngIf="(overlays$ | async).length > 0; else noConfigurations">
        <table style="width: 100%">
          <thead>
            <tr>
              <th i18n>Nazwa</th>
              <th i18n>URL nakładki</th>
              <th i18n>Warstwa</th>
              <th i18n>Pokaż w panelu</th>
              <!--<th i18n>Publiczna?</th>-->
              <th i18n>Data dodania</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let overlay of (overlays$ | async);trackBy:getOverlayId;index as $index" [ngClass]="{disabled: overlay.loadingDelete}">
              <td>{{overlay.caption}}</td>
              <td>{{overlay.url}}</td>
              <td>{{overlay.layerName}}</td>
              <td>
                <input *ngIf="!overlay.loadingVisible; else loadingVisibleRef" type="checkbox"
                       [formControl]="visibilityFCList[$index]">
                <ng-template #loadingVisibleRef>
                  <fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
                </ng-template>
              </td>
              <!--<th>Publiczna?</th>-->
              <td>{{overlay.created | S4EDate}}</td>
              <td>
                <button *ngIf="overlay.mine" [disabled]="overlay.loadingDelete" (click)="removeOverlay(overlay.id)">
                  <span *ngIf="!overlay.loadingDelete; else deleteLoadingRef" class="fa fa-trash"></span>
                  <ng-template #deleteLoadingRef>
                    <fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
                  </ng-template>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
        <section class="element" role="menuitem" *ngFor="let config of (overlays$ | async)">
        </section>
      </div>
      <ng-template #noConfigurations>
        <span i18n>Brak zapisanych widoków</span>
      </ng-template>

      <ng-container *ngIf="hasCustomOverlays$ | async">
        <button *ngIf="!(showOverlayForm$ | async)"
                class="button button--secondary button--small"
                type="button" (click)="showOverlayForm(true)" i18n>Dodaj Nakładkę</button>
      </ng-container>
      <ng-container *ngIf="showOverlayForm$ | async">
        <form [formGroup]="newOverlayForm">
          <table style="width: 100%" [ngClass]="{disabled: addingNewLayer$ | async}">
            <tbody>
              <tr>
                <td><ext-input formControlName="layerName" label="Nazwa" i18n-label placeholder="Moja nakładka 1" i18n-placeholder></ext-input></td>
                <td><ext-input formControlName="url" label="URL" i18n-label placeholder="https://my-wms-server.com/..."></ext-input></td>
                <td><ext-input formControlName="layer" label="Warstwa" i18n-label placeholder="LAYER_W_1"></ext-input></td>
                <td>
                  <ng-container *ngIf="!(addingNewLayer$ | async); else createLoadingRef">
                    <button [disabled]="addingNewLayer$ | async" (click)="addNewOverlay()">賛</button>
                    <button [disabled]="addingNewLayer$ | async" (click)="showOverlayForm(false)">x</button>
                  </ng-container>
                  <ng-template #createLoadingRef>
                    <fa-icon [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
                  </ng-template>
                </td>
              </tr>
            </tbody>
          </table>
          <div>

          </div>
        </form>
      </ng-container>
    </ng-container>
    <ng-template #loadingRef>
      <div class="loading loading--form">
        <div class="loading__item"></div>
      </div>
    </ng-template>
  </div>
  <div class="s4e-modal-footer">
    <button class="button button--cancel button--small" type="button" (click)="dismiss()" i18n>Zamknij</button>
  </div>
</s4e-generic-modal>
