
<div class="section sidebar" style="z-index: 5; position: absolute;">
  <ul class="switch">
    <li [class.active]="isLinkActive('products')">
      <a [routerLink]="['./products']" queryParamsHandling="preserve" i18n>Zdjęcia Satelitarne</a>
    </li>
    <li [class.active]="isLinkActive('sentinel-search')">
      <a [routerLink]="['./sentinel-search']" queryParamsHandling="preserve" i18n>Szukaj Danych</a>
    </li>
  </ul>
  <router-outlet></router-outlet>
</div>

<s4e-legend *ngIf="legend$ | async"
            [isOpen]="(legendState$ | async).isOpen"
            (opened)="toggleLegend()"
            [activeLegend]="legend$ | async"
            class="legend"></s4e-legend>

<s4e-timeline class="section timeline"
              *ngIf="(activeProducts$ | async) != null"
              [scenes]="scenes$ | async"
              [currentDate]="currentTimelineDate$ | async"
              (dateSelected)="setDate($event)"
              [availableDates]="availableDates$ | async"
              (loadAvailableDates)="loadAvailableDates($event)"
              [loading]="scenesAreLoading$ | async"
              [activeScene]="activeScene$ | async"
              (selectedScene)="selectScene($event?.id)">
</s4e-timeline>

<s4e-map class="section map"
         #map
         [isWorking]="loading$ | async"
         (working)="mapService.setWorking($event)"
         [overlays]="overlays$ | async"
         [activeScene]="activeScene$ | async"
         [activeView]="activeView$ | async"
         (viewChanged)="viewChanged($event)"
>
</s4e-map>

<button (click)="toggleLoginOptions()" id="user-login-button" class="dropdown_button dropdown_button--login">
</button>
<ng-container *ngIf="showLoginOptions$ | async">
  <div class="dropdown_content dropdown_content--login">
    <span class="dropdown_header">Twoje Sat4Envi</span>
    <div class="dropdown_close" (click)="toggleLoginOptions(false)"></div>
    <ul>
      <ng-container *ngIf="!(userLoggedIn$ | async); else logoutLink">
        <li>
          <a routerLink="/login" i18n>Zaloguj</a>
        </li>
        <li>
          <a routerLink="/register" i18n>Zarejestruj</a>
        </li>
      </ng-container>
      <ng-template #logoutLink>
        <li>
          <a routerLink="/settings" i18n>Ustawienia</a>
        </li>
        <li>
          <a routerLink="/logout" i18n>Wyloguj</a>
        </li>
      </ng-template>
    </ul>
  </div>
</ng-container>


<ng-container *ngIf="userIsZK$ | async">
  <button (click)="toggleZKOptions()" id="zk-options-button" class="dropdown_button dropdown_button--zk">
  </button>
  <ng-container *ngIf="showZKOptions$ | async">
    <div class="dropdown_content dropdown_content--zk">
      <span class="dropdown_header">Zarządzanie kryzysowe</span>
      <div class="dropdown_close dropdown" (click)="toggleZKOptions(false)"></div>
      <ul>
        <li><a (click)="openReportModal()" href="javascript:undefined" i18n>Generuj Raport</a></li>
        <li><a (click)="openShareViewModal()" href="javascript:undefined" i18n>Wyślij widok jako wiadomość</a></li>
        <li><a (click)="downloadMapImage()" href="javascript:undefined" i18n>Zapisz Obraz</a></li>
        <li><a (click)="openSaveViewModal()" href="javascript:undefined" i18n>Zapisz widok</a></li>
        <li><a (click)="openListViewModal()" href="javascript:undefined" i18n>Wyświetl zapisane widoki</a></li>
        <li><a data-test-download-original [ngClass]="{disabled: (activeScene$ | async) == null}" [attr.href]="(activeScene$ | async) == null ? null : CONFIG.apiPrefixV1 + '/scenes/' + (activeScene$ | async)?.id + '/download'" target="_blank" i18n>Zapisz oryginalny plik sceny</a></li>
      </ul>
    </div>
  </ng-container>
</ng-container>
