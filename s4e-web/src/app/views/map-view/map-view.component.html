<s4e-view-manager class="section sidebar"
                  [overlays]="overlays$ | async"
                  [userLoggedIn]="userLoggedIn$ | async"
                  [loading]="viewManagerLoading$ | async"
                  [overlaysLoading]="false"
                  [products]="productsTypeList$ | async"
                  [productsLoading]="productLoading$ | async"
                  (logout)="logout()"
                  (selectOverlay)="selectOverlay($event)"
                  (selectProduct)="selectProduct($event)"
                  (searchForPlaces)="serachForPlaces($event)"
                  [searchResults]="placeSearchResults$ | async"
                  [searchResultsLoading]="placeSearchLoading$ | async"
                  [searchResultsOpen]="placeSearchResultsOpen$ | async"
                  (searchResultClicked)="navigateToPlace($event)">
</s4e-view-manager>
<s4e-legend *ngIf="legend$ | async"
            [isOpen]="(legendState$ | async).isOpen"
            (opened)="toggleLegend()"
            [activeLegend]="legend$ | async"
            class="legend"></s4e-legend>

<s4e-timeline class="section timeline"
              *ngIf="(activeProducts$ | async) != null"
              [scenes]="scenes$ | async"
              [currentDate]="currentTimelineDate$ | async"
              (dateSelected)="setDate($event)"
              [availableDates]="availableDates$ | async"
              (loadAvailableDates)="loadAvailableDates($event)"
              [loading]="scenesAreLoading$ | async"
              [activeProduct]="activeScene$ | async"
              (selectedScene)="selectScene($event?.id)">
</s4e-timeline>

<s4e-map class="section map"
         #map
         [selectedLocation]="selectedLocation$"
         [overlays]="overlays$ | async"
         [activeScene]="activeScene$ | async"
         (viewChanged)="viewChanged($event)"
>
</s4e-map>

<ng-container *ngIf="userLoggedIn$ | async">
  <button (click)="toggleZKOptions()" id="zk-options-button" style="position:absolute; right: 60px; top: 15px;" class="button button--default">
    <fa-icon icon="bars"></fa-icon>
  </button>
  <ng-container *ngIf="showZKOptions$ | async">
    <div class="backdrop" (click)="toggleZKOptions(false)"></div>
    <div class="zk-options">
      <ul>
        <li><a (click)="downloadMapImage()" href="javascript:undefined" i18n>Zapisz Obraz</a></li>
        <li><a (click)="openReportModal()" href="javascript:undefined" i18n>Zapisz Raport</a></li>
        <li><a (click)="openShareViewModal()" href="javascript:undefined" i18n>UdostÄ™pnij widok</a></li>
        <li><a (click)="openSaveViewModal()" href="javascript:undefined" i18n>Zapisz widok</a></li>
      </ul>
    </div>
  </ng-container>
</ng-container>
