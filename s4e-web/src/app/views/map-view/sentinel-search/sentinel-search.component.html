<div class="form form--sentinel">
  <form [formGroup]="form">
    <ul>
      <li>
        <label i18n>Satelita</label>
        <select formControlName="sentinelId">
          <option value="" i18n>Wybierz satelitę</option>
          <option *ngFor="let sentinel of (sentinels$ | async)" [value]="sentinel.id">{{sentinel.caption}}</option>
        </select>
        <span class="error" *ngIf="form.controls.sentinelId.hasError('required') && form.controls.sentinelId.touched" i18n>Musisz wybrać satelitę</span>
      </li>
      <li>
        <label i18n>Data skanowania</label>
        <div class="two__columns">
          <div class="column">
            <div class="datepicker">
              <input [owlDateTime]="start"  formControlName="dateStart" type="text"/>
              <button [owlDateTimeTrigger]="start" [disabled]="form.controls.dateStart.disabled"></button>
              <owl-date-time #start [pickerMode]="'popup'" [pickerType]="'calendar'"></owl-date-time>
            </div>
            <span class="error" *ngIf="form.controls.dateStart.hasError('required') && form.controls.dateStart.touched" i18n>Musisz podać datę skanowania</span>
          </div>
          <div class="column">
            <div class="datepicker">
              <input [owlDateTime]="end" formControlName="dateEnd" type="text"/>
              <button [owlDateTimeTrigger]="end" [disabled]="form.controls.dateEnd.disabled"></button>
              <owl-date-time #end [pickerMode]="'popup'" [pickerType]="'calendar'"></owl-date-time>
            </div>
            <span class="error" *ngIf="form.controls.dateEnd.hasError('required') && form.controls.dateEnd.touched" i18n>Musisz podać datę skanowania</span>
          </div>
        </div>
      </li>
      <li class="half__column">
        <label i18n>Poziom zachmurzenia</label>
        <div class="percent">
          <input formControlName="clouds" type="text" />
        </div>
      </li>
    </ul>
    <button class="button button--primary" (click)="search()" [disabled]="loading$ | async">
      <fa-icon class="spinner" [hidden]="!(loading$ | async)" [icon]="['fas', 'circle-notch']" [spin]="true"></fa-icon>
      <ng-container i18n>Szukaj</ng-container>
    </button>
  </form>

</div>

<section class="section" *ngIf="!(loading$ | async); else loadingRef">
  <header class="box__header" *ngIf="(searchResults$ | async).length > 0">
    <span class="box__title">
      Wyniki
    </span>
  </header>
  <ul class="search__result">
    <li *ngFor="let result of (searchResults$ | async)">
      <div class="quick__look">
        <img *ngIf="result.image" [attr.src]="result.image">
        <!-- miejsce na obrazek (miniaturke) quick look jak jest -->
      </div>
      <ul>
        <li><strong i18n>Mission:</strong> {{result.mission}}</li>
        <li><strong i18n>Instrument:</strong>  {{result.instrument}}</li>
        <li><strong i18n>Sensing Date:</strong>  {{result.sensingDate}}</li>
        <li><strong i18n>Size:</strong>  {{result.size}}</li>
      </ul>
      <a [attr.href]="result.url" target="_blank" class="download-link">Pobierz</a>
    </li>
  </ul>
</section>

<ng-template #loadingRef>
  <div class="loading loading--results"></div>
  <div class="loading loading--results"></div>
  <div class="loading loading--results"></div>
</ng-template>


